---
title: "DSE 6311 Hyperparameter Tuning & Model Evaluation"
author: "James Keegan"
date: "2025-04-24"
output: html_document
---

# Code Copied from Steven Martinez

############## Loading Libraries Function ####################

```{R}
load_libraries <- function(packages) {
  # Check for missing packages
  missing_packages <- packages[!(packages %in% installed.packages()[, "Package"])]
  
  # install missing packages
  if(length(missing_packages) > 0) {
    install.packages(missing_packages)
  }
  
  # Load all packages
  lapply(packages, library, character.only = TRUE)
  
  cat("All packages are loaded succesfully.\n")
}

# Loading necessary libraries
load_libraries(c("tidyverse", "lubridate", "stats", "ggplot2", "corrplot", "stringr", "stringi", "class", "tidymodels", "modeldata", "themis", "vip", "baguette", "janitor", "rvest", "yardstick", "gsheet", "caret", "randomForest", "here", "tibble", "dplyr", "ISAR", "tidyr", "mgcv", "teamcolors", "baseballr", "Lahman", "remotes", "ggcorrplot", "broom", "readr", "glmnet", "xgboost", "Matrix", "Metrics", "reshape2", "DMwR2", "splitstackshape"))

# Load only the necessary functions from 'car'
library(car, exclude = "select")

# Turning off warning messages
options(warnings = 0)

```

############################## Loading Dataset ####################################

```{R}
# Loading dataset
df <- read_csv("C:\\Users\\student\\Documents\\GitHub\\team-beta\\final_data\\balanced_rf_data.csv")
df <- df %>% rename_with(make.names)
df$TeamSuccess <- as.factor(df$TeamSuccess)

head(df)

```

```{R}
# My job for this week
# rf data knn model
# cross-validation: stratfied k-fold

```

```{R}

## Modelling

set.seed(123)

# Stratified 10-fold CV
ctrl <- trainControl(
  method = "cv",         # cross-validation
  number = 10,           # 10 folds
  savePredictions = "final"  # keep predictions for evaluation
)

```

```{R}
knn_model <- train(
  TeamSuccess ~ ., 
  data = df,
  method = "knn",          # K-Nearest Neighbors
  trControl = ctrl,
  tuneLength = 10,         # tests 10 different k values
  metric = "Accuracy"      # or "Kappa"
)

```

```{R}
pred <- knn_model$pred$pred
actual <- knn_model$pred$obs

# Ensure factor levels match (just in case)
pred <- factor(pred, levels = levels(actual))

# Confusion matrix and stats
confusionMatrix(pred, actual)

```
